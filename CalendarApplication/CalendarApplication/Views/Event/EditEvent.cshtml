@model CalendarApplication.Models.Event.EventEditModel

@{
    ViewBag.Title = "CreateEvent";
}

@using CalendarApplication.Models.Event

<h2>Create Event</h2>

<h3 style="color:red">@TempData["errorMsg"]</h3>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/date-picker-validator.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
<fieldset>
    <legend>Create New Event</legend>
    <h3>Basic event details:</h3>
    @Html.LabelFor(m => m.Name)
    @Html.TextBoxFor(m => m.Name)
    <br />
    <br />
    @Html.LabelFor(m => m.Start) <br />
    @Html.DateTimeEditorFor(m => m.Start, "g.today,l.End")
    <br />
    @Html.LabelFor(m => m.End) <br />
    @Html.DateTimeEditorFor(m => m.End, "g.today,g.Start")
    <br />
    @Html.HiddenFor(m => m.SubmitType)
    @Html.HiddenFor(m => m.ID)
    @Html.DropDownListFor(m => Model.SelectedEventType,
                            new SelectList(Model.EventTypes, "Value", "Text"),
                            new { onchange="this.form.submit()" })

    @if (Model.TypeSpecefics != null)
    {
        <table>
            @for (int i = 0; i < Model.TypeSpecefics.Count; i++)
            {
                <tr>
                    <td>@Model.TypeSpecefics[i].Name</td>
                    <td>
                        @Html.HiddenFor(m => Model.TypeSpecefics[i].ID)
                        @Html.HiddenFor(m => Model.TypeSpecefics[i].Datatype)
                        @switch (Model.TypeSpecefics[i].Datatype)
                        {
                            case 0:
                            case 3:
                            case 4: @Html.TextBoxFor(m => Model.TypeSpecefics[i].IntValue);
                                    @Html.ValidationMessageFor(m => Model.TypeSpecefics[i].IntValue) break;
                            case 1:
                            case 2:
                            case 5: @Html.TextBoxFor(m => Model.TypeSpecefics[i].StringValue);
                                    @Html.ValidationMessageFor(m => Model.TypeSpecefics[i].StringValue) break;
                            case 6: @Html.CheckBoxFor(m => Model.TypeSpecefics[i].BoolValue);
                                    @Html.ValidationMessageFor(m => Model.TypeSpecefics[i].BoolValue) break;
                        }
                        @if (Model.TypeSpecefics[i].Required)
                        { <span style='color:red'>*</span> }
                    </td>
                </tr>
            }           
        </table>
    }
    <br />
    <br />

    @Html.ListEditorFor(m => m.RoomSelectList, "Rooms Selected", "Rooms Available")

    <br />
    <input type="submit" value="Create event" onclick="document.getElementById('SubmitType').value = 1" />

</fieldset>
}